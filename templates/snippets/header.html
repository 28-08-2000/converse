{% load static %}

<style type="text/css">
	.chat-dropdown-header:hover{
		cursor: pointer;
		background: var(--main-background-color);
	}
	.chat-dropdown-header{
		color: var(--light-primary-text-color);
	}

	.margin{
		margin-right:1em;
	}

.navbar-dark .navbar-brand {
    color: #FF1493 ;
}

	.headtitle{
  font-size: 28px;
  font-style: italic;
  font-weight: bold;
  font-family: 'Averia Serif Libre', cursive;
}
.headlinks{
	font-size:20px;
  font-family: 'Averia Serif Libre';
	}

</style>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Averia+Serif+Libre:wght@300&display=swap" rel="stylesheet">

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <!-- Navbar content -->
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
    <a class="navbar-brand headtitle" >Converse</a>
    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
      <li class="nav-item ">
        <a class="nav-link headlinks" href="{% url 'home' %}">Home <span class="sr-only">(current)</span></a>
      </li>
      <li  class="nav-item ">
		  <a class="nav-link headlinks" href="../../blogs/all">Blogs</a>
      </li>
    </ul>
	  {% if request.user.is_authenticated %}
    <form class="form-inline my-2 my-lg-0" onsubmit="return executeQuery();">
      <input class="form-control mr-sm-2" type="text" name="q" name="q" id="id_q" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
	</form>
	  	{% else %}
			<!-- <h3>Register to search</h3> -->
		{% endif %}


	  {% if request.user.is_authenticated %}
					<div class="dropdown dropleft show p-2">
						<div class="d-flex flex-row">

							<div class="btn-group dropleft">
								<div class="d-flex notifications-icon-container rounded-circle align-items-center mr-3" id="id_chat_notification_dropdown_toggle" data-toggle="dropdown">
									<span id="id_chat_notifications_count" class="notify-badge"></span>
									<span class="d-flex material-icons notifications-material-icon m-auto align-items-center">chat</span>
									<div class="dropdown-menu scrollable-menu" aria-labelledby="id_chat_notification_dropdown_toggle" id="id_chat_notifications_container">

									</div>
								</div>
							</div>

							<div class="btn-group dropleft">
								<div class="d-flex notifications-icon-container rounded-circle align-items-center mr-3" id="id_notification_dropdown_toggle" data-toggle="dropdown" onclick="setGeneralNotificationsAsRead()">
									<span id="id_general_notifications_count" class="notify-badge"></span>
									<span class="d-flex material-icons notifications-material-icon m-auto align-items-center">notifications</span>
									<div class="dropdown-menu scrollable-menu" aria-labelledby="id_notification_dropdown_toggle" id="id_general_notifications_container">
									</div>
								</div>
							</div>

							<div class="btn-group dropleft">
								<img class="account-image rounded-circle m-auto d-block dropdown-toggle" id="id_profile_links" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" src="{% static 'icons/account.png' %}" alt="my logo" width="40" height="40">
								<div class="dropdown-menu" aria-labelledby="id_profile_links">
									<a class="dropdown-item" href="{% url 'account:view' user_id=request.user.id %}">Account</a>
									<a class="dropdown-item" href="{% url 'logout' %}">Logout</a>
								</div>
							</div>
						</div>

					</div>
				{% else %}
					<a class="btn btn-success margin" href="{% url 'login' %}">Login</a>
					<a class="btn btn-outline-primary margin" href="{% url 'register' %}">Register</a>
				{% endif %}
  </div>
</nav>


<!-- Header -->
<!--<div class="d-flex flex-column flex-lg-row p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">-->

	<!-- MEDIUM+ SCREENS -->
<!--	<div class="d-none d-md-flex flex-row my-auto flex-grow-1 align-items-center">-->
<!--		<h5 class="mr-3 font-weight-normal justify-content-start">-->
<!--			<a class="p-2 text-dark" href="{% url 'home' %}">Home</a>-->
<!--		</h5>-->
		<!-- make the search field available only to registered users -->
<!--		{% if request.user.is_authenticated %}-->
<!--			<form class="search-bar justify-content-start" onsubmit="return executeQuery();">-->
<!--				<input type="text" class="form-control" name="q" id="id_q_large" placeholder="Search...">-->
<!--			</form>-->
<!--		{% else %}-->
<!--			&lt;!&ndash; <h3>Register to search</h3> &ndash;&gt;-->
<!--		{% endif %}	-->
		

<!--		<div class="d-flex flex-row-reverse flex-grow-1">-->
<!--			<nav class="">-->
<!--				{% if request.user.is_authenticated %}-->
<!--					<div class="dropdown dropleft show p-2">-->
<!--						<div class="d-flex flex-row">-->

<!--							<div class="btn-group dropleft">-->
<!--								<div class="d-flex notifications-icon-container rounded-circle align-items-center mr-3" id="id_chat_notification_dropdown_toggle" data-toggle="dropdown">-->
<!--									<span id="id_chat_notifications_count" class="notify-badge"></span>-->
<!--									<span class="d-flex material-icons notifications-material-icon m-auto align-items-center">chat</span>-->
<!--									<div class="dropdown-menu scrollable-menu" aria-labelledby="id_chat_notification_dropdown_toggle" id="id_chat_notifications_container">-->
<!--											-->
<!--									</div>-->
<!--								</div>-->
<!--							</div>-->

<!--							<div class="btn-group dropleft">-->
<!--								<div class="d-flex notifications-icon-container rounded-circle align-items-center mr-3" id="id_notification_dropdown_toggle" data-toggle="dropdown" onclick="setGeneralNotificationsAsRead()">-->
<!--									<span id="id_general_notifications_count" class="notify-badge"></span>-->
<!--									<span class="d-flex material-icons notifications-material-icon m-auto align-items-center">notifications</span>-->
<!--									<div class="dropdown-menu scrollable-menu" aria-labelledby="id_notification_dropdown_toggle" id="id_general_notifications_container">										-->
<!--									</div>-->
<!--								</div>-->
<!--							</div>-->

<!--							<div class="btn-group dropleft">-->
<!--								<img class="account-image rounded-circle m-auto d-block dropdown-toggle" id="id_profile_links" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" src="{% static 'icons/account.png' %}" alt="my logo" width="40" height="40">-->
<!--								<div class="dropdown-menu" aria-labelledby="id_profile_links">-->
<!--									<a class="dropdown-item" href="{% url 'account:view' user_id=request.user.id %}">Account</a>-->
<!--									<a class="dropdown-item" href="{% url 'logout' %}">Logout</a>-->
<!--								</div>-->
<!--							</div>-->
<!--						</div>-->
<!--						-->
<!--					</div>-->
<!--				{% else %}-->
<!--					<a class="p-2 text-dark" href="{% url 'login' %}">Login</a>-->
<!--					<a class="btn btn-outline-primary" href="{% url 'register' %}">Register</a> -->
<!--				{% endif %}	-->
<!--			</nav>-->
<!--		</div>-->
<!--	</div>-->
	<!-- END MEDIUM+ SCREENS -->

<!--	&lt;!&ndash; SMALL SCREENS &ndash;&gt;-->
<!--	<div class="d-flex d-md-none flex-column my-auto align-items-center">-->
<!--		<h5 class="font-weight-normal">-->
<!--		<a class="p-2 text-dark" href="{% url 'home' %}">Home</a>-->
<!--		</h5>-->
<!--		<form class="search-bar justify-content-start" onsubmit="return executeQuery();">-->
<!--			<input type="text" class="form-control" name="q" id="id_q_small" placeholder="Search..." onsubmit="return executeQuery();">-->
<!--		</form>-->
<!--		<div class="d-flex flex-row-reverse flex-grow-1">-->
<!--			<nav class="">-->
<!--				{% if request.user.is_authenticated %}-->
<!--				<div class="dropdown dropleft p-2 mt-2">-->
<!--					<div class="d-flex flex-row">-->
<!--						<div class="btn-group dropleft">-->
<!--							<img class="account-image rounded-circle m-auto d-block dropdown-toggle" id="id_profile_links" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" src="{% static 'icons/account.png' %}" alt="user logo" width="40" height="40">-->
<!--							<div class="dropdown-menu" aria-labelledby="id_profile_links">-->
<!--								<a class="dropdown-item" href="{% url 'account:view' user_id=request.user.id %}">Account</a>-->
<!--								&lt;!&ndash; removed this logout option for privatechat &ndash;&gt;-->
<!--								&lt;!&ndash; <a class="dropdown-item" href="{% url 'logout' %}">Logout</a> &ndash;&gt;-->
<!--							</div>-->
<!--						</div>-->
<!--					</div>-->
<!--				</div>-->
<!--				{% else %}-->
<!--					<a class="p-2 text-dark" href="{% url 'login' %}">Login</a>-->
<!--					<a class="btn btn-outline-primary" href="{% url 'register' %}">Register</a> -->
<!--				{% endif %}	-->
<!--			</nav>-->
<!--	  	</div>-->
<!--	</div>-->
	<!-- END SMALL SCREENS -->
<!--</div>-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

</script>
<!-- for the search users (on header) -->
<script type="text/javascript">
	// for drop down thing
	setupChatDropdownHeader()

	function executeQuery() {
		var query = ""
		query = document.getElementById('id_q').value;
		console.log(query)
		if (query == ""){
			query = document.getElementById('id_q').value;
		}
	    window.location.replace("{% url 'search' %}?q=" + query)
	    return false
	}

	/*
		Add a header to the dropdown so users can visit /chat/
	*/
	function setupChatDropdownHeader(){
		var notificationContainer = document.getElementById("id_chat_notifications_container")

		if(notificationContainer != null){

			var div = document.createElement("div")
			div.classList.add("chat-dropdown-header", "d-flex", "flex-row", "justify-content-end", "m-auto", "align-items-end")
			div.addEventListener("click", function(e){
				var url = "{% url 'privatechat:private-chat-room' %}"
				chatRedirect(url)
			})

			span1 = document.createElement("span")
			span1.classList.add("mr-2")
			span1.innerHTML = "Go to chat"
			div.appendChild(span1)

			span2 = document.createElement("span")
			span2.classList.add("material-icons", "mr-2")
			span2.innerHTML = "open_with"
			div.appendChild(span2)
			notificationContainer.appendChild(div)
		}
	}

	function chatRedirect(url){
		window.location.href = url
	}


</script>